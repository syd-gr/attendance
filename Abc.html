<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Management System</title>
    <style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 12px; /* Adjusted size for better A4 fit */
    }
    th, td {
        border: 1px solid black;
        padding: 5px;
        text-align: center;
    }
    th {
        background-color: #f2f2f2;
    }
    tfoot {
        font-weight: bold;
    }
    td:nth-child(16) {
        width: 200px; /* Keeping the "事由" column larger */
    }

    /* Print-specific styles */
    @media print {
        th:nth-child(3), td:nth-child(3),
        th:nth-child(5), td:nth-child(5) {
            display: none;
        }
    }
</style>

</head>
<body>
    <h2>Attendance Management System</h2>
    <label>Name: <input type="text" id="name"></label>
    <label>Company Name: 
        <select id="company">
            <option value="Work-Change">Work-Change</option>
            <option value="Centurion-Facilities">Centurion-Facilities</option>
            <option value="H & S Partners">H & S Partners</option>
            <option value="Joining Job">Joining Job</option>
            <option value="Desti Japan">Desti Japan</option>
        </select>
    </label>
    <label>Month: 
        <select id="month" onchange="populateTable()">
            <option value="0">January</option>
            <option value="1">February</option>
            <option value="2">March</option>
            <option value="3">April</option>
            <option value="4">May</option>
            <option value="5">June</option>
            <option value="6">July</option>
            <option value="7">August</option>
            <option value="8">September</option>
            <option value="9">October</option>
            <option value="10">November</option>
            <option value="11">December</option>
        </select>
    </label>
    <label>Year: <input type="number" id="year" value="2025" min="2000" max="2100" onchange="populateTable()"></label>
    <button onclick="populateTable()">Generate</button>
    <button onclick="window.print()">Print</button>
    
    <table id="attendanceTable">
        <thead>
    <tr>
        <th>Date</th>
        <th>曜日</th>
        <th>Holiday</th>
        <th>Work Start Time</th>
        <th>Same as Above</th>
        <th>Work End Time</th>
        <th>Break Time</th>
        <th>Overtime</th>
        <th>Total Working Time</th>
        <th>残業</th>
        <th>欠勤</th>
        <th>遅刻</th>
        <th>早退</th>
        <th>有給</th>
        <th>出張</th>
        <th>事由</th>
        <th>確認印（サイン）</th>
    </tr>
</thead>
<tbody>
</tbody>
        <tfoot>
            <tr>
                <td colspan="6">Total Working Days:<span id="totalWorkingDays">0</span></td>
                <td id="totalBreakTime">0</td>
                <td id="totalOvertime">0</td>
                <td id="totalWorkingTime">0</td>
            </tr>
        </tfoot>
    </table>
    <h3><span id="totalWorkingDays"></span></h3>

    <script>
        function populateTable() {
            let tableBody = document.querySelector("#attendanceTable tbody");
            tableBody.innerHTML = "";
            let selectedMonth = parseInt(document.getElementById("month").value);
            let selectedYear = parseInt(document.getElementById("year").value);
            let monthDays = new Date(selectedYear, selectedMonth + 1, 0).getDate();
            let weekdays = ["日曜日", "月曜日", "火曜日", "水曜日", "木曜日", "金曜日", "土曜日"];
            
            for (let i = 1; i <= monthDays; i++) {
                let row = document.createElement("tr");
                let date = new Date(selectedYear, selectedMonth, i);
                let dateString = `${selectedYear}-${String(selectedMonth + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                let dayString = weekdays[date.getDay()];
                
                row.innerHTML = `
                    <td>${dateString}</td>
                    <td>${dayString}</td>
                    <td><input type="checkbox" class="holidayCheckbox" onchange="toggleHoliday(this)"></td>
                    <td><input type="time" class="startTime" onchange="calculateTime(this)"></td>
                    <td><input type="checkbox" class="sameAsAbove" onchange="copyPreviousRow(this)"></td>
                    <td><input type="time" class="endTime" onchange="calculateTime(this)"></td>
                    <td><input type="number" class="breakTime" value="1" min="0" step="0.5" onchange="calculateTime(this)"></td>
                    <td class="overtime">0</td>
                    <td class="totalWorkingTime">0</td>
                    <td><input type="checkbox" class="overtimeCheckbox"></td>
                    <td><input type="checkbox" class="absenceCheckbox"></td>
                    <td><input type="checkbox" class="latenessCheckbox"></td>
                    <td><input type="checkbox" class="earlyLeaveCheckbox"></td>
                    <td><input type="checkbox" class="paidLeaveCheckbox"></td>
                    <td><input type="checkbox" class="businessTripCheckbox"></td>
                    <td><input type="text" class="reasonText"></td>
                    <td></td>
                `;
                tableBody.appendChild(row);
            }
        }
    </script>
</body>
</html>
